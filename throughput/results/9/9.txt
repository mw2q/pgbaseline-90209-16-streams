BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%saddle%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264577969.933343
 ALGERIA                   |   1997 | 457727451.975626
 ALGERIA                   |   1996 | 464707630.994788
 ALGERIA                   |   1995 |  464054430.81525
 ALGERIA                   |   1994 | 466777586.133231
 ALGERIA                   |   1993 | 462703188.097757
 ALGERIA                   |   1992 | 462234356.512053
 ARGENTINA                 |   1998 | 278672866.789855
 ARGENTINA                 |   1997 | 469437862.845285
 ARGENTINA                 |   1996 | 466533550.652208
 ARGENTINA                 |   1995 | 467572608.197572
 ARGENTINA                 |   1994 |  471372862.47291
 ARGENTINA                 |   1993 | 468652657.226022
 ARGENTINA                 |   1992 | 463133483.128351
 BRAZIL                    |   1998 | 277461146.698478
 BRAZIL                    |   1997 | 472771272.447056
 BRAZIL                    |   1996 | 473113494.182923
 BRAZIL                    |   1995 | 467415104.108167
 BRAZIL                    |   1994 | 465618039.298191
 BRAZIL                    |   1993 | 469651994.929535
 BRAZIL                    |   1992 | 469410877.450318
 CANADA                    |   1998 | 272091102.659919
 CANADA                    |   1997 | 474439320.265293
 CANADA                    |   1996 | 474906743.223374
 CANADA                    |   1995 | 481124868.025378
 CANADA                    |   1994 | 475429668.912593
 CANADA                    |   1993 | 485480274.772809
 CANADA                    |   1992 | 479118071.074353
 CHINA                     |   1998 | 274236457.163189
 CHINA                     |   1997 | 465916668.561893
 CHINA                     |   1996 |  461624148.52849
 CHINA                     |   1995 | 468987581.162626
 CHINA                     |   1994 | 465672665.376832
 CHINA                     |   1993 | 464710232.881232
 CHINA                     |   1992 | 468427430.551881
 EGYPT                     |   1998 | 267180172.756338
 EGYPT                     |   1997 | 455232917.552159
 EGYPT                     |   1996 | 458742077.034743
 EGYPT                     |   1995 | 459129933.070283
 EGYPT                     |   1994 | 454119357.159439
 EGYPT                     |   1993 |  466585263.89383
 EGYPT                     |   1992 | 447408666.260732
 ETHIOPIA                  |   1998 |  270653250.67162
 ETHIOPIA                  |   1997 | 466867108.199741
 ETHIOPIA                  |   1996 | 463346539.349745
 ETHIOPIA                  |   1995 | 457567003.824623
 ETHIOPIA                  |   1994 | 464453862.591272
 ETHIOPIA                  |   1993 | 462910505.718666
 ETHIOPIA                  |   1992 | 469541092.836129
 FRANCE                    |   1998 | 267278157.035764
 FRANCE                    |   1997 | 456267192.108462
 FRANCE                    |   1996 | 456312437.297776
 FRANCE                    |   1995 | 461515387.635062
 FRANCE                    |   1994 |  468523371.86335
 FRANCE                    |   1993 | 461535270.149604
 FRANCE                    |   1992 |  462262033.95975
 GERMANY                   |   1998 | 277269427.616358
 GERMANY                   |   1997 | 480165367.177516
 GERMANY                   |   1996 | 480863059.252003
 GERMANY                   |   1995 | 479820503.811839
 GERMANY                   |   1994 | 479675389.705047
 GERMANY                   |   1993 |  483652157.51636
 GERMANY                   |   1992 |  479948541.54354
 INDIA                     |   1998 | 275774599.471322
 INDIA                     |   1997 |  475583574.28405
 INDIA                     |   1996 | 474219633.471802
 INDIA                     |   1995 | 480709342.159199
 INDIA                     |   1994 |  486981056.58141
 INDIA                     |   1993 | 473314079.704071
 INDIA                     |   1992 | 477109613.494118
 INDONESIA                 |   1998 | 269636319.910454
 INDONESIA                 |   1997 | 465336015.336645
 INDONESIA                 |   1996 |  470631968.16182
 INDONESIA                 |   1995 | 466207039.077689
 INDONESIA                 |   1994 | 472754017.634963
 INDONESIA                 |   1993 |  466329478.41252
 INDONESIA                 |   1992 | 468582184.659941
 IRAN                      |   1998 |  264630198.51743
 IRAN                      |   1997 | 455447406.523346
 IRAN                      |   1996 | 458444975.045779
 IRAN                      |   1995 | 459506369.226862
 IRAN                      |   1994 | 451815768.383597
 IRAN                      |   1993 | 453701378.908728
 IRAN                      |   1992 | 460000043.115327
 IRAQ                      |   1998 | 280992727.017403
 IRAQ                      |   1997 | 467808499.661839
 IRAQ                      |   1996 | 470643355.091569
 IRAQ                      |   1995 | 467182454.090257
 IRAQ                      |   1994 | 476853578.291391
 IRAQ                      |   1993 | 472406955.087271
 IRAQ                      |   1992 | 478005349.836802
 JAPAN                     |   1998 | 264783109.892059
 JAPAN                     |   1997 | 464653168.569908
 JAPAN                     |   1996 | 463247564.047003
 JAPAN                     |   1995 | 459104545.764359
 JAPAN                     |   1994 | 461793607.485563
 JAPAN                     |   1993 | 464820575.566085
 JAPAN                     |   1992 |  465929698.94689
 JORDAN                    |   1998 | 273012456.476235
 JORDAN                    |   1997 | 459935595.316068
 JORDAN                    |   1996 | 466451601.162962
 JORDAN                    |   1995 | 460978944.633425
 JORDAN                    |   1994 | 466816531.463761
 JORDAN                    |   1993 |   462162636.1243
 JORDAN                    |   1992 | 459641327.032556
 KENYA                     |   1998 | 267685405.480268
 KENYA                     |   1997 | 462833882.874133
 KENYA                     |   1996 | 469053581.981546
 KENYA                     |   1995 | 470700966.961159
 KENYA                     |   1994 | 462452194.353688
 KENYA                     |   1993 |  469371995.15445
 KENYA                     |   1992 | 473269923.458856
 MOROCCO                   |   1998 |  272266191.44488
 MOROCCO                   |   1997 |  471046639.66988
 MOROCCO                   |   1996 | 466768631.581862
 MOROCCO                   |   1995 |  470323585.58729
 MOROCCO                   |   1994 | 466628407.778743
 MOROCCO                   |   1993 | 471663265.339285
 MOROCCO                   |   1992 | 478295959.615501
 MOZAMBIQUE                |   1998 | 272288565.168209
 MOZAMBIQUE                |   1997 | 462935204.621966
 MOZAMBIQUE                |   1996 | 468348653.573887
 MOZAMBIQUE                |   1995 | 458362789.931142
 MOZAMBIQUE                |   1994 | 463332204.486302
 MOZAMBIQUE                |   1993 | 456527626.579498
 MOZAMBIQUE                |   1992 | 454300430.819159
 PERU                      |   1998 | 278132904.670066
 PERU                      |   1997 | 469960677.062269
 PERU                      |   1996 |  469214732.73487
 PERU                      |   1995 | 467691878.749896
 PERU                      |   1994 | 462786841.278723
 PERU                      |   1993 | 467105613.931097
 PERU                      |   1992 | 463950095.006824
 ROMANIA                   |   1998 | 272749813.909445
 ROMANIA                   |   1997 |  462925383.13864
 ROMANIA                   |   1996 | 471432031.392288
 ROMANIA                   |   1995 | 466084725.462534
 ROMANIA                   |   1994 | 461737930.269921
 ROMANIA                   |   1993 | 458666718.482094
 ROMANIA                   |   1992 | 467130391.626871
 RUSSIA                    |   1998 | 277355851.530822
 RUSSIA                    |   1997 |  475176914.68815
 RUSSIA                    |   1996 | 482150887.144628
 RUSSIA                    |   1995 | 467777977.680558
 RUSSIA                    |   1994 | 476171963.274277
 RUSSIA                    |   1993 | 474703135.547372
 RUSSIA                    |   1992 | 467245037.627306
 SAUDI ARABIA              |   1998 | 278299569.578963
 SAUDI ARABIA              |   1997 | 472559979.732649
 SAUDI ARABIA              |   1996 | 481477185.037545
 SAUDI ARABIA              |   1995 | 474173302.500117
 SAUDI ARABIA              |   1994 | 473644367.501633
 SAUDI ARABIA              |   1993 | 473262078.689253
 SAUDI ARABIA              |   1992 | 474314583.775275
 UNITED KINGDOM            |   1998 | 270339214.770786
 UNITED KINGDOM            |   1997 | 461625457.925568
 UNITED KINGDOM            |   1996 | 470179381.310853
 UNITED KINGDOM            |   1995 | 471969609.675617
 UNITED KINGDOM            |   1994 | 470513293.893687
 UNITED KINGDOM            |   1993 | 471389847.183777
 UNITED KINGDOM            |   1992 | 468656188.221413
 UNITED STATES             |   1998 | 276981754.287603
 UNITED STATES             |   1997 | 473010355.706807
 UNITED STATES             |   1996 | 477271338.659485
 UNITED STATES             |   1995 | 476217954.692043
 UNITED STATES             |   1994 | 483576486.274979
 UNITED STATES             |   1993 | 474099201.608883
 UNITED STATES             |   1992 | 473880909.434644
 VIETNAM                   |   1998 | 276247097.279258
 VIETNAM                   |   1997 | 468322447.428685
 VIETNAM                   |   1996 | 470269366.464356
 VIETNAM                   |   1995 | 467874372.862228
 VIETNAM                   |   1994 | 464017627.009561
 VIETNAM                   |   1993 | 473526961.786903
 VIETNAM                   |   1992 | 470404299.152932
(175 rows)

COMMIT;
COMMIT
