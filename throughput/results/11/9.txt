BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%papaya%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 263564572.953581
 ALGERIA                   |   1997 | 447383279.507886
 ALGERIA                   |   1996 | 450047300.589798
 ALGERIA                   |   1995 | 451932097.790862
 ALGERIA                   |   1994 | 450834201.582018
 ALGERIA                   |   1993 | 449192894.297753
 ALGERIA                   |   1992 | 460598252.398019
 ARGENTINA                 |   1998 | 276134680.849894
 ARGENTINA                 |   1997 | 465507688.248945
 ARGENTINA                 |   1996 |  470014006.87488
 ARGENTINA                 |   1995 | 463141294.906469
 ARGENTINA                 |   1994 | 459120558.253969
 ARGENTINA                 |   1993 | 461580481.280015
 ARGENTINA                 |   1992 | 474360142.134076
 BRAZIL                    |   1998 | 274321291.194986
 BRAZIL                    |   1997 | 464946421.627771
 BRAZIL                    |   1996 | 466452049.640355
 BRAZIL                    |   1995 | 467978481.076176
 BRAZIL                    |   1994 | 473965642.617396
 BRAZIL                    |   1993 | 470217594.739247
 BRAZIL                    |   1992 | 465517511.072809
 CANADA                    |   1998 | 280021136.855568
 CANADA                    |   1997 | 477031352.842487
 CANADA                    |   1996 | 472735594.064142
 CANADA                    |   1995 | 477940696.282722
 CANADA                    |   1994 | 480708568.519744
 CANADA                    |   1993 | 481940093.727549
 CANADA                    |   1992 | 476095199.913825
 CHINA                     |   1998 | 276400338.596596
 CHINA                     |   1997 | 469670018.408251
 CHINA                     |   1996 | 469426471.326969
 CHINA                     |   1995 | 475567464.733802
 CHINA                     |   1994 | 469359745.335966
 CHINA                     |   1993 | 467285722.382481
 CHINA                     |   1992 | 474922736.361158
 EGYPT                     |   1998 | 268401063.245252
 EGYPT                     |   1997 |  463896722.69287
 EGYPT                     |   1996 | 464668552.224412
 EGYPT                     |   1995 | 458446581.558905
 EGYPT                     |   1994 | 462878957.371194
 EGYPT                     |   1993 | 461507948.924489
 EGYPT                     |   1992 | 462466417.511108
 ETHIOPIA                  |   1998 | 267506046.432543
 ETHIOPIA                  |   1997 | 455146055.452946
 ETHIOPIA                  |   1996 | 448886403.751143
 ETHIOPIA                  |   1995 | 457030572.809787
 ETHIOPIA                  |   1994 | 461635246.260614
 ETHIOPIA                  |   1993 | 448428580.638568
 ETHIOPIA                  |   1992 | 458847392.033851
 FRANCE                    |   1998 | 269366478.119241
 FRANCE                    |   1997 | 461071724.779322
 FRANCE                    |   1996 | 466264169.564172
 FRANCE                    |   1995 | 465329848.108479
 FRANCE                    |   1994 | 451168674.889599
 FRANCE                    |   1993 |  460242720.69676
 FRANCE                    |   1992 | 459786111.828104
 GERMANY                   |   1998 | 277877114.243757
 GERMANY                   |   1997 | 472936546.352811
 GERMANY                   |   1996 | 474970226.228695
 GERMANY                   |   1995 | 478456705.424828
 GERMANY                   |   1994 | 473305245.692277
 GERMANY                   |   1993 | 479461160.500974
 GERMANY                   |   1992 | 472974973.143395
 INDIA                     |   1998 | 274623588.709858
 INDIA                     |   1997 | 472527149.824021
 INDIA                     |   1996 | 468894860.423851
 INDIA                     |   1995 | 468742851.368235
 INDIA                     |   1994 | 474113496.929521
 INDIA                     |   1993 | 467330295.711885
 INDIA                     |   1992 | 464431874.838251
 INDONESIA                 |   1998 | 271778641.836833
 INDONESIA                 |   1997 | 465868386.336341
 INDONESIA                 |   1996 | 468832638.114556
 INDONESIA                 |   1995 | 466087883.590895
 INDONESIA                 |   1994 | 459282236.509406
 INDONESIA                 |   1993 | 476753411.295593
 INDONESIA                 |   1992 |   471270978.7608
 IRAN                      |   1998 | 273728848.484562
 IRAN                      |   1997 | 464821529.446063
 IRAN                      |   1996 | 474042734.629337
 IRAN                      |   1995 | 463948166.611878
 IRAN                      |   1994 | 472416229.570199
 IRAN                      |   1993 | 474362420.090389
 IRAN                      |   1992 | 476580244.397244
 IRAQ                      |   1998 | 276933050.694803
 IRAQ                      |   1997 | 469896684.915791
 IRAQ                      |   1996 | 469945884.768443
 IRAQ                      |   1995 | 467731323.476783
 IRAQ                      |   1994 | 480854427.026761
 IRAQ                      |   1993 | 476536732.619009
 IRAQ                      |   1992 | 469702575.203928
 JAPAN                     |   1998 | 271025464.218314
 JAPAN                     |   1997 | 463310287.767911
 JAPAN                     |   1996 | 474164772.083198
 JAPAN                     |   1995 | 472669947.694656
 JAPAN                     |   1994 | 466173205.691606
 JAPAN                     |   1993 | 470826009.089597
 JAPAN                     |   1992 | 468889584.782054
 JORDAN                    |   1998 | 268553261.044013
 JORDAN                    |   1997 |  459409634.18528
 JORDAN                    |   1996 | 460459228.342923
 JORDAN                    |   1995 | 449084228.667781
 JORDAN                    |   1994 | 459288458.497532
 JORDAN                    |   1993 | 462088941.592387
 JORDAN                    |   1992 | 455769298.312982
 KENYA                     |   1998 | 270955560.213493
 KENYA                     |   1997 | 475701465.176884
 KENYA                     |   1996 | 476130793.111108
 KENYA                     |   1995 | 477714856.575414
 KENYA                     |   1994 | 477182922.307036
 KENYA                     |   1993 | 470662416.093169
 KENYA                     |   1992 | 470066335.454018
 MOROCCO                   |   1998 |  275387817.29078
 MOROCCO                   |   1997 | 460287903.713447
 MOROCCO                   |   1996 | 463026219.723695
 MOROCCO                   |   1995 | 467818601.479036
 MOROCCO                   |   1994 | 462941017.055876
 MOROCCO                   |   1993 | 467278733.483798
 MOROCCO                   |   1992 | 472921199.837717
 MOZAMBIQUE                |   1998 |  261718948.66836
 MOZAMBIQUE                |   1997 | 446882598.717605
 MOZAMBIQUE                |   1996 | 456617744.890976
 MOZAMBIQUE                |   1995 | 462655965.415821
 MOZAMBIQUE                |   1994 | 450690696.184044
 MOZAMBIQUE                |   1993 | 456469170.807023
 MOZAMBIQUE                |   1992 | 448290914.014436
 PERU                      |   1998 | 275509955.948858
 PERU                      |   1997 | 461241647.336927
 PERU                      |   1996 | 464531870.488682
 PERU                      |   1995 | 461485046.558352
 PERU                      |   1994 | 468505193.261844
 PERU                      |   1993 | 459750256.156781
 PERU                      |   1992 | 457155716.472269
 ROMANIA                   |   1998 | 273632149.006056
 ROMANIA                   |   1997 | 461337998.541511
 ROMANIA                   |   1996 | 466875791.868414
 ROMANIA                   |   1995 | 467050757.353646
 ROMANIA                   |   1994 |  463065802.27418
 ROMANIA                   |   1993 | 459469096.878723
 ROMANIA                   |   1992 | 464697399.552051
 RUSSIA                    |   1998 | 275790245.256408
 RUSSIA                    |   1997 | 479807027.851373
 RUSSIA                    |   1996 | 476973218.679024
 RUSSIA                    |   1995 |  467724811.78015
 RUSSIA                    |   1994 | 470414574.261055
 RUSSIA                    |   1993 | 474443506.070324
 RUSSIA                    |   1992 | 475767596.503841
 SAUDI ARABIA              |   1998 | 277998241.995812
 SAUDI ARABIA              |   1997 | 473695742.949974
 SAUDI ARABIA              |   1996 | 478684507.648122
 SAUDI ARABIA              |   1995 | 470257868.961568
 SAUDI ARABIA              |   1994 | 481117003.787295
 SAUDI ARABIA              |   1993 | 471748332.543392
 SAUDI ARABIA              |   1992 | 472415258.755587
 UNITED KINGDOM            |   1998 | 280620173.779083
 UNITED KINGDOM            |   1997 | 467507864.974684
 UNITED KINGDOM            |   1996 | 465030692.142679
 UNITED KINGDOM            |   1995 | 470451704.917857
 UNITED KINGDOM            |   1994 | 462504286.465011
 UNITED KINGDOM            |   1993 | 472868391.908885
 UNITED KINGDOM            |   1992 | 465310930.952119
 UNITED STATES             |   1998 | 272979634.471742
 UNITED STATES             |   1997 | 476474503.187223
 UNITED STATES             |   1996 | 472112024.307829
 UNITED STATES             |   1995 | 477751614.528334
 UNITED STATES             |   1994 | 474337146.524297
 UNITED STATES             |   1993 | 476797499.597584
 UNITED STATES             |   1992 | 469009065.297205
 VIETNAM                   |   1998 | 274549553.846497
 VIETNAM                   |   1997 | 470032135.093769
 VIETNAM                   |   1996 | 470656076.821645
 VIETNAM                   |   1995 | 466355032.355868
 VIETNAM                   |   1994 | 464924056.322072
 VIETNAM                   |   1993 | 474665816.648801
 VIETNAM                   |   1992 | 471042661.886324
(175 rows)

COMMIT;
COMMIT
