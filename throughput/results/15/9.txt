BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%indian%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264177407.501272
 ALGERIA                   |   1997 | 465118063.131428
 ALGERIA                   |   1996 | 455569971.039522
 ALGERIA                   |   1995 | 467482829.230976
 ALGERIA                   |   1994 | 454714456.125406
 ALGERIA                   |   1993 | 462398523.860114
 ALGERIA                   |   1992 | 462285323.345967
 ARGENTINA                 |   1998 | 270165348.007466
 ARGENTINA                 |   1997 | 468862269.765716
 ARGENTINA                 |   1996 |  468174973.78087
 ARGENTINA                 |   1995 | 463591096.530057
 ARGENTINA                 |   1994 | 464447382.889398
 ARGENTINA                 |   1993 | 457833684.692525
 ARGENTINA                 |   1992 | 456744698.630175
 BRAZIL                    |   1998 | 278681146.965573
 BRAZIL                    |   1997 | 464593414.150064
 BRAZIL                    |   1996 | 469667157.032084
 BRAZIL                    |   1995 | 462099503.426125
 BRAZIL                    |   1994 | 465200184.254825
 BRAZIL                    |   1993 | 464489620.207775
 BRAZIL                    |   1992 | 475779239.207492
 CANADA                    |   1998 | 275240613.556041
 CANADA                    |   1997 |  482571582.72873
 CANADA                    |   1996 | 484388701.520671
 CANADA                    |   1995 | 484862177.621073
 CANADA                    |   1994 |   485241590.9042
 CANADA                    |   1993 | 487561671.361787
 CANADA                    |   1992 | 473505822.973943
 CHINA                     |   1998 | 272333712.221062
 CHINA                     |   1997 | 463582711.863332
 CHINA                     |   1996 | 465435520.557279
 CHINA                     |   1995 |  463868323.29773
 CHINA                     |   1994 | 462117575.810194
 CHINA                     |   1993 | 466015782.478133
 CHINA                     |   1992 | 462353812.617261
 EGYPT                     |   1998 | 269434850.856924
 EGYPT                     |   1997 | 462162095.900313
 EGYPT                     |   1996 | 466299908.005091
 EGYPT                     |   1995 | 465619489.455828
 EGYPT                     |   1994 | 454918039.354153
 EGYPT                     |   1993 | 475268918.556447
 EGYPT                     |   1992 | 466102935.483944
 ETHIOPIA                  |   1998 | 272293257.588641
 ETHIOPIA                  |   1997 | 462575445.103464
 ETHIOPIA                  |   1996 | 450936275.291878
 ETHIOPIA                  |   1995 | 464395595.314121
 ETHIOPIA                  |   1994 | 462183640.764592
 ETHIOPIA                  |   1993 | 457118313.064457
 ETHIOPIA                  |   1992 | 463384193.622697
 FRANCE                    |   1998 | 267623422.444819
 FRANCE                    |   1997 | 463368169.170789
 FRANCE                    |   1996 | 470805447.766346
 FRANCE                    |   1995 | 466787429.756139
 FRANCE                    |   1994 | 465965575.704014
 FRANCE                    |   1993 | 468199982.732397
 FRANCE                    |   1992 | 462783563.497957
 GERMANY                   |   1998 | 281433085.880789
 GERMANY                   |   1997 | 469696988.080863
 GERMANY                   |   1996 | 478132382.576632
 GERMANY                   |   1995 | 468486961.722368
 GERMANY                   |   1994 | 474774143.048858
 GERMANY                   |   1993 | 476593904.913684
 GERMANY                   |   1992 | 480704991.397484
 INDIA                     |   1998 | 276242034.798188
 INDIA                     |   1997 | 471930511.030836
 INDIA                     |   1996 | 471467989.267042
 INDIA                     |   1995 | 476244193.092423
 INDIA                     |   1994 | 474646423.078167
 INDIA                     |   1993 | 469307924.018283
 INDIA                     |   1992 | 467997089.116257
 INDONESIA                 |   1998 | 273225477.066388
 INDONESIA                 |   1997 | 453996806.461706
 INDONESIA                 |   1996 | 466927870.196552
 INDONESIA                 |   1995 | 466464982.509846
 INDONESIA                 |   1994 | 460386988.496793
 INDONESIA                 |   1993 | 471489894.895751
 INDONESIA                 |   1992 | 466297770.428371
 IRAN                      |   1998 | 270978512.790674
 IRAN                      |   1997 | 456368128.954804
 IRAN                      |   1996 | 458053945.666265
 IRAN                      |   1995 | 463692054.628173
 IRAN                      |   1994 | 462092348.418169
 IRAN                      |   1993 | 453381398.307406
 IRAN                      |   1992 | 453517339.418951
 IRAQ                      |   1998 |  277994548.22165
 IRAQ                      |   1997 |  474273947.46617
 IRAQ                      |   1996 | 467055049.053119
 IRAQ                      |   1995 | 468366801.185191
 IRAQ                      |   1994 | 474562864.374819
 IRAQ                      |   1993 | 466183016.164302
 IRAQ                      |   1992 | 468428673.046381
 JAPAN                     |   1998 | 267213127.983848
 JAPAN                     |   1997 | 463407395.240185
 JAPAN                     |   1996 | 459756480.191519
 JAPAN                     |   1995 | 467510811.232534
 JAPAN                     |   1994 | 461775874.840872
 JAPAN                     |   1993 | 465761644.764111
 JAPAN                     |   1992 | 465356485.272833
 JORDAN                    |   1998 | 264126729.544955
 JORDAN                    |   1997 |  456862425.78251
 JORDAN                    |   1996 |  457956847.14475
 JORDAN                    |   1995 | 456280003.815556
 JORDAN                    |   1994 | 455684627.638758
 JORDAN                    |   1993 | 453469224.761679
 JORDAN                    |   1992 | 459586031.627686
 KENYA                     |   1998 | 277034974.598048
 KENYA                     |   1997 | 472588461.770662
 KENYA                     |   1996 | 471642192.664866
 KENYA                     |   1995 | 468646433.409057
 KENYA                     |   1994 | 465940083.722527
 KENYA                     |   1993 |  462703025.46216
 KENYA                     |   1992 | 465353749.054228
 MOROCCO                   |   1998 | 275726952.036047
 MOROCCO                   |   1997 | 466877947.499815
 MOROCCO                   |   1996 | 468454215.714299
 MOROCCO                   |   1995 | 466630512.016536
 MOROCCO                   |   1994 | 468983992.307708
 MOROCCO                   |   1993 | 479196206.794998
 MOROCCO                   |   1992 | 462726465.191075
 MOZAMBIQUE                |   1998 | 273503079.703377
 MOZAMBIQUE                |   1997 | 461346802.401105
 MOZAMBIQUE                |   1996 | 463497399.893658
 MOZAMBIQUE                |   1995 | 463893292.499763
 MOZAMBIQUE                |   1994 | 460046888.530452
 MOZAMBIQUE                |   1993 | 459431936.694791
 MOZAMBIQUE                |   1992 | 461886771.653654
 PERU                      |   1998 |  276179566.76336
 PERU                      |   1997 | 475815880.687944
 PERU                      |   1996 | 465763525.365064
 PERU                      |   1995 | 468043263.528714
 PERU                      |   1994 | 460618017.848587
 PERU                      |   1993 | 471801903.321139
 PERU                      |   1992 | 472425817.577675
 ROMANIA                   |   1998 | 276045500.520582
 ROMANIA                   |   1997 | 465005268.815885
 ROMANIA                   |   1996 | 457285867.949828
 ROMANIA                   |   1995 | 468508122.436649
 ROMANIA                   |   1994 | 467266585.103127
 ROMANIA                   |   1993 | 464749618.781837
 ROMANIA                   |   1992 | 461789913.278816
 RUSSIA                    |   1998 | 284337384.724404
 RUSSIA                    |   1997 |  472781463.50926
 RUSSIA                    |   1996 | 483607150.261851
 RUSSIA                    |   1995 | 467397562.736805
 RUSSIA                    |   1994 | 476213403.627852
 RUSSIA                    |   1993 | 469250410.503744
 RUSSIA                    |   1992 | 469564062.689829
 SAUDI ARABIA              |   1998 | 272895020.006707
 SAUDI ARABIA              |   1997 | 465746884.861171
 SAUDI ARABIA              |   1996 | 469927575.954826
 SAUDI ARABIA              |   1995 | 467189045.056654
 SAUDI ARABIA              |   1994 | 469530135.456344
 SAUDI ARABIA              |   1993 | 468962032.711203
 SAUDI ARABIA              |   1992 | 468705759.245845
 UNITED KINGDOM            |   1998 | 276834763.193522
 UNITED KINGDOM            |   1997 |  467715945.65795
 UNITED KINGDOM            |   1996 | 475263117.483578
 UNITED KINGDOM            |   1995 |  471617962.90799
 UNITED KINGDOM            |   1994 | 464538969.172282
 UNITED KINGDOM            |   1993 | 476488908.770559
 UNITED KINGDOM            |   1992 |  458213411.90917
 UNITED STATES             |   1998 | 274532898.251371
 UNITED STATES             |   1997 | 467291732.929875
 UNITED STATES             |   1996 | 469901702.399311
 UNITED STATES             |   1995 | 463899550.925796
 UNITED STATES             |   1994 |  468805093.70174
 UNITED STATES             |   1993 | 463857983.324532
 UNITED STATES             |   1992 | 467263024.418135
 VIETNAM                   |   1998 | 265815451.143451
 VIETNAM                   |   1997 | 457819502.790587
 VIETNAM                   |   1996 | 462681718.508205
 VIETNAM                   |   1995 | 458179877.603058
 VIETNAM                   |   1994 | 464806289.898682
 VIETNAM                   |   1993 | 460692895.241523
 VIETNAM                   |   1992 | 456466737.849709
(175 rows)

COMMIT;
COMMIT
