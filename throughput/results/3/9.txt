BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%cornflower%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264147836.346846
 ALGERIA                   |   1997 | 456679235.813046
 ALGERIA                   |   1996 | 462908319.154831
 ALGERIA                   |   1995 | 465537785.836425
 ALGERIA                   |   1994 | 452636608.861455
 ALGERIA                   |   1993 | 456021853.970213
 ALGERIA                   |   1992 | 466788522.979709
 ARGENTINA                 |   1998 | 275544207.385673
 ARGENTINA                 |   1997 | 462037897.114738
 ARGENTINA                 |   1996 |  465689504.35072
 ARGENTINA                 |   1995 | 470703119.483162
 ARGENTINA                 |   1994 | 467690634.546029
 ARGENTINA                 |   1993 | 461244145.855893
 ARGENTINA                 |   1992 | 459940122.971526
 BRAZIL                    |   1998 | 280526759.822243
 BRAZIL                    |   1997 |  474280781.65948
 BRAZIL                    |   1996 | 467869390.204309
 BRAZIL                    |   1995 | 466870864.881905
 BRAZIL                    |   1994 | 471681115.407172
 BRAZIL                    |   1993 | 466810465.622865
 BRAZIL                    |   1992 | 469121985.811536
 CANADA                    |   1998 | 280696790.657431
 CANADA                    |   1997 | 474986677.895921
 CANADA                    |   1996 | 477735734.439815
 CANADA                    |   1995 | 473044542.960097
 CANADA                    |   1994 | 490602842.651903
 CANADA                    |   1993 | 484442174.828898
 CANADA                    |   1992 | 480884547.532282
 CHINA                     |   1998 | 274493758.734725
 CHINA                     |   1997 | 469427418.159314
 CHINA                     |   1996 |  473237669.73583
 CHINA                     |   1995 | 469802480.482051
 CHINA                     |   1994 | 462069354.268379
 CHINA                     |   1993 | 464625941.218569
 CHINA                     |   1992 | 466968686.490482
 EGYPT                     |   1998 | 275129421.195946
 EGYPT                     |   1997 | 465992686.662704
 EGYPT                     |   1996 | 476321316.477783
 EGYPT                     |   1995 | 468683665.690262
 EGYPT                     |   1994 | 467616316.413787
 EGYPT                     |   1993 | 472686967.723131
 EGYPT                     |   1992 | 465083158.568462
 ETHIOPIA                  |   1998 | 265757234.738477
 ETHIOPIA                  |   1997 | 453543643.780357
 ETHIOPIA                  |   1996 | 455153386.785998
 ETHIOPIA                  |   1995 | 458744099.201922
 ETHIOPIA                  |   1994 | 457031168.196177
 ETHIOPIA                  |   1993 |   455448523.7559
 ETHIOPIA                  |   1992 | 461594672.950734
 FRANCE                    |   1998 | 271714182.727179
 FRANCE                    |   1997 | 455991077.630673
 FRANCE                    |   1996 | 470688401.173443
 FRANCE                    |   1995 | 456053162.119876
 FRANCE                    |   1994 | 461956509.286994
 FRANCE                    |   1993 | 467445977.420247
 FRANCE                    |   1992 | 461920381.163742
 GERMANY                   |   1998 | 284581338.993107
 GERMANY                   |   1997 | 485102289.583788
 GERMANY                   |   1996 | 486372266.842481
 GERMANY                   |   1995 | 488711797.831567
 GERMANY                   |   1994 | 492149554.901603
 GERMANY                   |   1993 | 482911060.812436
 GERMANY                   |   1992 | 484538331.545101
 INDIA                     |   1998 | 274771280.899013
 INDIA                     |   1997 | 475860629.895712
 INDIA                     |   1996 | 474046749.387868
 INDIA                     |   1995 | 470360123.186826
 INDIA                     |   1994 | 473450228.816577
 INDIA                     |   1993 | 464353176.801643
 INDIA                     |   1992 | 474618984.465527
 INDONESIA                 |   1998 | 269421052.033992
 INDONESIA                 |   1997 | 460550147.732255
 INDONESIA                 |   1996 | 466568392.214548
 INDONESIA                 |   1995 | 460976113.949778
 INDONESIA                 |   1994 | 457364172.048086
 INDONESIA                 |   1993 | 463587888.168227
 INDONESIA                 |   1992 | 457770978.444042
 IRAN                      |   1998 | 279327491.950246
 IRAN                      |   1997 | 467607658.694897
 IRAN                      |   1996 | 469008766.248787
 IRAN                      |   1995 |  474509152.10506
 IRAN                      |   1994 |  473220035.19704
 IRAN                      |   1993 | 463543575.313574
 IRAN                      |   1992 | 471773478.267725
 IRAQ                      |   1998 | 277213828.490619
 IRAQ                      |   1997 | 464790428.179754
 IRAQ                      |   1996 | 472375946.808792
 IRAQ                      |   1995 | 463663021.044032
 IRAQ                      |   1994 | 466385121.676032
 IRAQ                      |   1993 | 467180737.237464
 IRAQ                      |   1992 | 467428549.884017
 JAPAN                     |   1998 | 274321431.157675
 JAPAN                     |   1997 | 472836446.686557
 JAPAN                     |   1996 |  462309918.15837
 JAPAN                     |   1995 | 460612311.848134
 JAPAN                     |   1994 | 468933373.383484
 JAPAN                     |   1993 | 468246690.152181
 JAPAN                     |   1992 | 472662919.909087
 JORDAN                    |   1998 | 273276874.399402
 JORDAN                    |   1997 | 469980307.092535
 JORDAN                    |   1996 | 468894520.628746
 JORDAN                    |   1995 | 465814283.159913
 JORDAN                    |   1994 | 469222142.537224
 JORDAN                    |   1993 | 469163261.036883
 JORDAN                    |   1992 | 467250814.318697
 KENYA                     |   1998 | 278802953.898085
 KENYA                     |   1997 | 471127604.239119
 KENYA                     |   1996 | 473827162.627915
 KENYA                     |   1995 | 467871131.674189
 KENYA                     |   1994 | 474120331.845333
 KENYA                     |   1993 | 458907854.899752
 KENYA                     |   1992 | 466810673.801544
 MOROCCO                   |   1998 | 280204187.599994
 MOROCCO                   |   1997 | 474265895.156884
 MOROCCO                   |   1996 | 470892078.010604
 MOROCCO                   |   1995 | 468629062.072646
 MOROCCO                   |   1994 | 469388695.145255
 MOROCCO                   |   1993 | 463055528.120123
 MOROCCO                   |   1992 | 471446465.137216
 MOZAMBIQUE                |   1998 |  273211427.68962
 MOZAMBIQUE                |   1997 | 466266260.980039
 MOZAMBIQUE                |   1996 | 466791108.316686
 MOZAMBIQUE                |   1995 | 470066809.283104
 MOZAMBIQUE                |   1994 | 458733775.612724
 MOZAMBIQUE                |   1993 | 467208206.835306
 MOZAMBIQUE                |   1992 | 460663329.485737
 PERU                      |   1998 | 266301399.130161
 PERU                      |   1997 |  457916027.51599
 PERU                      |   1996 | 457479281.524294
 PERU                      |   1995 | 455115683.060043
 PERU                      |   1994 | 463541632.098628
 PERU                      |   1993 |  465298506.58403
 PERU                      |   1992 | 458143296.402481
 ROMANIA                   |   1998 | 273054523.601378
 ROMANIA                   |   1997 | 465011489.099349
 ROMANIA                   |   1996 | 474877002.780436
 ROMANIA                   |   1995 | 467645895.605382
 ROMANIA                   |   1994 | 466927691.912811
 ROMANIA                   |   1993 | 467525355.929977
 ROMANIA                   |   1992 | 465136528.799307
 RUSSIA                    |   1998 | 272721201.087153
 RUSSIA                    |   1997 | 469580186.177976
 RUSSIA                    |   1996 | 467242185.808108
 RUSSIA                    |   1995 | 470543683.611945
 RUSSIA                    |   1994 | 468941900.108656
 RUSSIA                    |   1993 | 471361361.968206
 RUSSIA                    |   1992 | 465936527.833343
 SAUDI ARABIA              |   1998 |  275175464.36478
 SAUDI ARABIA              |   1997 | 468535799.863567
 SAUDI ARABIA              |   1996 | 466191448.913981
 SAUDI ARABIA              |   1995 | 472396697.349477
 SAUDI ARABIA              |   1994 | 465584466.138752
 SAUDI ARABIA              |   1993 | 474892884.633786
 SAUDI ARABIA              |   1992 | 467942342.101241
 UNITED KINGDOM            |   1998 | 269869480.796269
 UNITED KINGDOM            |   1997 | 453628422.414108
 UNITED KINGDOM            |   1996 | 462396809.319949
 UNITED KINGDOM            |   1995 |  454138068.73155
 UNITED KINGDOM            |   1994 | 450758188.180364
 UNITED KINGDOM            |   1993 | 452137400.383295
 UNITED KINGDOM            |   1992 | 463643637.517001
 UNITED STATES             |   1998 | 275879267.234087
 UNITED STATES             |   1997 | 481114393.722421
 UNITED STATES             |   1996 | 470021193.877875
 UNITED STATES             |   1995 | 474195822.654603
 UNITED STATES             |   1994 | 475977539.072236
 UNITED STATES             |   1993 | 484485568.972803
 UNITED STATES             |   1992 | 474378545.575214
 VIETNAM                   |   1998 | 269639121.852312
 VIETNAM                   |   1997 | 463475198.785219
 VIETNAM                   |   1996 | 469343268.893967
 VIETNAM                   |   1995 |  472312074.30896
 VIETNAM                   |   1994 | 466473398.706127
 VIETNAM                   |   1993 | 465430101.900471
 VIETNAM                   |   1992 | 465699479.345841
(175 rows)

COMMIT;
COMMIT
