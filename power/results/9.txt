BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%honeydew%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 271966985.702458
 ALGERIA                   |   1997 | 458339409.088162
 ALGERIA                   |   1996 | 455449538.383843
 ALGERIA                   |   1995 | 463656732.837171
 ALGERIA                   |   1994 | 456346768.640836
 ALGERIA                   |   1993 | 465833329.032291
 ALGERIA                   |   1992 | 456717463.821003
 ARGENTINA                 |   1998 | 281895484.326413
 ARGENTINA                 |   1997 | 476716081.743414
 ARGENTINA                 |   1996 | 474309289.871996
 ARGENTINA                 |   1995 | 478866600.298734
 ARGENTINA                 |   1994 | 479302582.667743
 ARGENTINA                 |   1993 | 476924724.688833
 ARGENTINA                 |   1992 | 480227470.710624
 BRAZIL                    |   1998 |  274672369.62948
 BRAZIL                    |   1997 | 476331299.702263
 BRAZIL                    |   1996 | 471839337.469751
 BRAZIL                    |   1995 | 470893617.968174
 BRAZIL                    |   1994 | 480165013.607863
 BRAZIL                    |   1993 | 465950347.086014
 BRAZIL                    |   1992 | 473852425.902072
 CANADA                    |   1998 | 281362829.128643
 CANADA                    |   1997 | 477028504.066511
 CANADA                    |   1996 | 469901337.350117
 CANADA                    |   1995 | 474786639.307903
 CANADA                    |   1994 | 479904138.561248
 CANADA                    |   1993 | 470383698.737592
 CANADA                    |   1992 | 470523848.089883
 CHINA                     |   1998 | 274329375.535027
 CHINA                     |   1997 | 467390842.168938
 CHINA                     |   1996 | 475631943.713686
 CHINA                     |   1995 | 470092554.588261
 CHINA                     |   1994 |  475499633.22756
 CHINA                     |   1993 |  468265520.70994
 CHINA                     |   1992 | 478658462.263073
 EGYPT                     |   1998 | 272078166.503223
 EGYPT                     |   1997 | 471435197.648499
 EGYPT                     |   1996 |  474189527.33997
 EGYPT                     |   1995 | 459182662.851791
 EGYPT                     |   1994 | 461643878.975286
 EGYPT                     |   1993 | 466680742.241219
 EGYPT                     |   1992 | 464604695.090584
 ETHIOPIA                  |   1998 | 276887942.340524
 ETHIOPIA                  |   1997 | 464947699.704343
 ETHIOPIA                  |   1996 | 465070706.073311
 ETHIOPIA                  |   1995 | 468834248.931601
 ETHIOPIA                  |   1994 | 468108002.964019
 ETHIOPIA                  |   1993 | 467800434.416536
 ETHIOPIA                  |   1992 | 466878513.883249
 FRANCE                    |   1998 | 264565758.970548
 FRANCE                    |   1997 | 453661493.727499
 FRANCE                    |   1996 | 456610000.407731
 FRANCE                    |   1995 | 453878732.416689
 FRANCE                    |   1994 | 450978567.681029
 FRANCE                    |   1993 |  452670014.54487
 FRANCE                    |   1992 | 456071344.620725
 GERMANY                   |   1998 | 282177726.658546
 GERMANY                   |   1997 | 477129356.392547
 GERMANY                   |   1996 | 478656448.792257
 GERMANY                   |   1995 | 486146429.549486
 GERMANY                   |   1994 |  476804172.93156
 GERMANY                   |   1993 | 475104927.158938
 GERMANY                   |   1992 |  480702574.65089
 INDIA                     |   1998 | 276896742.146082
 INDIA                     |   1997 | 472210262.971327
 INDIA                     |   1996 | 474799212.642056
 INDIA                     |   1995 | 476030109.636436
 INDIA                     |   1994 | 472288754.883366
 INDIA                     |   1993 | 468721685.936588
 INDIA                     |   1992 | 473118028.501933
 INDONESIA                 |   1998 | 272739189.544659
 INDONESIA                 |   1997 | 465219837.923957
 INDONESIA                 |   1996 | 465393232.683421
 INDONESIA                 |   1995 | 456035346.627437
 INDONESIA                 |   1994 | 465890754.686253
 INDONESIA                 |   1993 | 461920193.779383
 INDONESIA                 |   1992 | 462846781.670288
 IRAN                      |   1998 | 274233368.936478
 IRAN                      |   1997 | 470448447.747164
 IRAN                      |   1996 | 466089779.950713
 IRAN                      |   1995 | 462846617.032558
 IRAN                      |   1994 | 461398635.443716
 IRAN                      |   1993 | 469336457.330759
 IRAN                      |   1992 | 465283221.220484
 IRAQ                      |   1998 | 274199918.324176
 IRAQ                      |   1997 | 466601177.035444
 IRAQ                      |   1996 | 469824466.462202
 IRAQ                      |   1995 |  468408193.99858
 IRAQ                      |   1994 | 463710845.996774
 IRAQ                      |   1993 | 471201183.829044
 IRAQ                      |   1992 | 470977377.650795
 JAPAN                     |   1998 | 272304288.081311
 JAPAN                     |   1997 | 472662465.069411
 JAPAN                     |   1996 | 456384877.833097
 JAPAN                     |   1995 | 463994332.001155
 JAPAN                     |   1994 | 471107739.401647
 JAPAN                     |   1993 | 464019195.702944
 JAPAN                     |   1992 | 466440763.069951
 JORDAN                    |   1998 | 272637942.613666
 JORDAN                    |   1997 | 460734636.647143
 JORDAN                    |   1996 | 458323597.306007
 JORDAN                    |   1995 | 466727468.032451
 JORDAN                    |   1994 | 463397597.956604
 JORDAN                    |   1993 | 473998134.862411
 JORDAN                    |   1992 | 457440429.579105
 KENYA                     |   1998 | 276731467.818917
 KENYA                     |   1997 | 470736123.185116
 KENYA                     |   1996 | 469938070.449697
 KENYA                     |   1995 | 467557671.950925
 KENYA                     |   1994 | 469607155.300434
 KENYA                     |   1993 | 468891367.180681
 KENYA                     |   1992 | 470220050.504702
 MOROCCO                   |   1998 | 274323251.293593
 MOROCCO                   |   1997 |  468893171.39629
 MOROCCO                   |   1996 | 472482201.933734
 MOROCCO                   |   1995 | 473492030.632161
 MOROCCO                   |   1994 | 473154205.866339
 MOROCCO                   |   1993 | 474063839.145045
 MOROCCO                   |   1992 |  473031026.89034
 MOZAMBIQUE                |   1998 | 269911655.126652
 MOZAMBIQUE                |   1997 | 456881895.396861
 MOZAMBIQUE                |   1996 | 467849618.773375
 MOZAMBIQUE                |   1995 | 465727232.381338
 MOZAMBIQUE                |   1994 |  464100811.80071
 MOZAMBIQUE                |   1993 | 452539570.731754
 MOZAMBIQUE                |   1992 | 458245108.099408
 PERU                      |   1998 | 265902508.900971
 PERU                      |   1997 | 460643536.913296
 PERU                      |   1996 | 458632877.267265
 PERU                      |   1995 | 460543202.523973
 PERU                      |   1994 | 450631681.344493
 PERU                      |   1993 | 454005669.180855
 PERU                      |   1992 | 461444144.132438
 ROMANIA                   |   1998 | 282597144.269492
 ROMANIA                   |   1997 | 473603746.818543
 ROMANIA                   |   1996 | 475577943.820523
 ROMANIA                   |   1995 | 476249291.421823
 ROMANIA                   |   1994 | 475457749.868169
 ROMANIA                   |   1993 | 475620128.970962
 ROMANIA                   |   1992 | 471894873.874816
 RUSSIA                    |   1998 | 283295837.949286
 RUSSIA                    |   1997 | 479974562.963021
 RUSSIA                    |   1996 | 474968811.069242
 RUSSIA                    |   1995 | 480516126.256812
 RUSSIA                    |   1994 |   480225560.5261
 RUSSIA                    |   1993 | 477458525.520421
 RUSSIA                    |   1992 | 479005686.807875
 SAUDI ARABIA              |   1998 | 272598905.281648
 SAUDI ARABIA              |   1997 | 459316615.438468
 SAUDI ARABIA              |   1996 | 469130583.744941
 SAUDI ARABIA              |   1995 | 468835306.587543
 SAUDI ARABIA              |   1994 | 461243522.220571
 SAUDI ARABIA              |   1993 | 459828205.615736
 SAUDI ARABIA              |   1992 | 460183512.577032
 UNITED KINGDOM            |   1998 | 271245316.049102
 UNITED KINGDOM            |   1997 |  466109260.09126
 UNITED KINGDOM            |   1996 | 461011989.102797
 UNITED KINGDOM            |   1995 | 463926430.692089
 UNITED KINGDOM            |   1994 | 467771873.662462
 UNITED KINGDOM            |   1993 | 469765885.590865
 UNITED KINGDOM            |   1992 | 469623477.722076
 UNITED STATES             |   1998 |   277465455.6103
 UNITED STATES             |   1997 |  474291364.68067
 UNITED STATES             |   1996 | 472980405.918559
 UNITED STATES             |   1995 | 472447102.248934
 UNITED STATES             |   1994 | 481086901.892544
 UNITED STATES             |   1993 | 480202886.868103
 UNITED STATES             |   1992 | 475802123.804359
 VIETNAM                   |   1998 | 274385220.110843
 VIETNAM                   |   1997 | 468453652.092639
 VIETNAM                   |   1996 | 470598873.565327
 VIETNAM                   |   1995 | 467242127.804933
 VIETNAM                   |   1994 | 464928451.166925
 VIETNAM                   |   1993 | 466224605.855104
 VIETNAM                   |   1992 | 461443137.005288
(175 rows)

COMMIT;
COMMIT
